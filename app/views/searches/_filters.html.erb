

<%
   # check for existing tags in query string
   existing_tag_facets = []
   if params[:tags].present?
     existing_tag_facets = params[:tags]
   end

   @tag_facet_links_off = ''
   tag_facet_links_off_counter = 1
   @tag_facet_links_on = ''
   @tag_filter_list = []

   @tags.each do |t| 
    tag_facets = existing_tag_facets + [t["id"]]
    @tag_facet_links_off << "<li>(#{t["tag_count"]}) #{link_to t["name"], update_search_path(params.merge(:tags => tag_facets))}</li>"
    tag_facet_links_off_counter = tag_facet_links_off_counter + 1
  end

%>

<div id="tags" data-step="1" data-intro="Click 'More Tags' to see all available tags" data-position="top" class="col-md-12 col-sm-4 margin-bottom-10">
  <h3><strong>Tag(s)</strong></h3>
  <% if @search.tags && @search.tags.length > 1 %>
    <ul class="list-unstyled">
      <li><b>Filtering By:</b></li>

    </ul>
  <% end %>

    <ul class="list-unstyled">
      <% if @tag_facet_links_on.length > 1 and @tag_facet_links_off.length > 1 %><li><b>Available Tags:</b></li><% end %>
      <%= raw @tag_facet_links_off %>
    </ul>

  <% if tag_facet_links_off_counter > 8 %>
      <div class="text-center"><a class="expandTagsList"><i class="fa fa-arrow-circle-down"></i> More Tags</a></div>
  <% end %>
</div>


<div class="col-md-12 col-sm-4 margin-bottom-10">
  <h3><strong>Uploaded By</strong></h3>

</div>

<script type="text/javascript">
    $(document).ready(function () {

        <% if !params.has_key?('more_tags') %>
        $('#tags li:gt(8)').hide();
        <% else %>
        $('#tags li:gt(15)').hide();
        introJs().start();
        <% end %>

        $('#tags .expandTagsList').click(function() {

            if(this.innerHTML == '<i class="fa fa-arrow-circle-down"></i> More Tags') {
                $('#tags li:gt(8)').show();
                this.innerHTML = '<i class="fa fa-arrow-circle-up"></i> Less Tags';
            } else {
                $('#tags li:gt(8)').hide();
                this.innerHTML = '<i class="fa fa-arrow-circle-down"></i> More Tags';
            }
        });

    });
</script>
