<% if params[:organization_id].present? and Organization.where(id: params[:organization_id]).exists? %>
    <% @organization =  Organization.find(params[:organization_id]) %>
    <%= render partial: 'organizations/info', locals: { :short => true } %>
    <%= link_to url_for(update_search_path(params.except(:organization_id))), class: 'pull-right' do %>
        <i class="fa fa-times-circle"></i> reset filter
    <% end %>
<% else %>
    <ul id="orglist" class="list-unstyled">
      <% for row in @search_results.facet(:organization_id).rows %>
          <% if !row.instance.nil? %>
              <li>
                (<%= row.count %>) <%= link_to row.instance.name, update_search_path(params.merge(:organization_id => row.value).except(:page)) %>
              </li>
          <% end %>
      <% end %>
    </ul>
    <% if @search_results.facet(:organization_id).rows.count > 5 %>
        <p><a id="expandOrgsList"><i class="fa fa-arrow-circle-down"></i> More Organizations</a></p>
    <% end %>
<% end %>

<script>

    $(document).ready(function () {

        $('#orglist li:gt(4)').hide();

        $('#expandOrgsList').click(function() {

            if(this.innerHTML == '<i class="fa fa-arrow-circle-down"></i> More Organizations') {
                $('#orglist li:gt(4)').show();
                this.innerHTML = '<i class="fa fa-arrow-circle-up"></i> Less Organizations';
            } else {
                $('#orglist li:gt(4)').hide();
                this.innerHTML = '<i class="fa fa-arrow-circle-down"></i> More Organizations';
            }
        });


    });
</script>


